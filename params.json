{"name":"Nake","tagline":"Write you build automation scripts in C# without paying the angle bracket tax!","body":"## Nake\r\n\r\nNake is a magic task runner tool for .NET. It was built by unicorns flying in a rainbows and it's well seasoned by lots of fairy dust. Nake is simply that build/deployment/ops automation tool you were dreaming of.\r\n\r\nJokes aside, it's the only tool which can give you an imperative/functional convenience of Rake/MSBuild, but without forcing you (and your team) to learn yet another language and without pricking you eyes by hordes of angle brackets. \r\n\r\nAt last! Now you can automate your tasks by writing a 100% idiomatic C# code without any limitations (and with all the power of .NET framework) using a lightweight scripting approach. No projects, no pre-compilation, using any text editor. \r\n\r\nNake's DSL for defining tasks is uniquely minimal and it was carefully crafted to be a 100% IntelliSense compatible. And no worries, Nake has great MSBuild interoperability story, so you can easily import and execute any built-in or third-party MSBuild tasks.\r\n\r\n## Getting Started\r\n\r\n### How to install\r\n\r\nThere multiple ways in which Nake could be installed. You can install it by using NuGet [package](https://www.nuget.org/packages/Nake), or you can install it by downloading a [standalone](https://github.com/yevhen/Nake/releases) executable from GitHub releases page, and of course you can always build it from sources. \r\n\r\nTo install Nake via NuGet, run this command in NuGet package manager console:\r\n\r\n\tPM> Install-Package Nake \r\n\r\n#### IntelliSense and syntax highlighting\r\n\r\nYou can install [Roslyn CTP](http://www.microsoft.com/en-us/download/details.aspx?id=34685) extension to get IntelliSense support in Visual Studio 2012. IntelliSense for other versions of Visual Studio is not available at the moment. \r\n\r\nSyntax highlighting for `.csx` files is easy to get - it is just standard C# code, so just map `.csx` file extension in you favorite text editor to be recognized as C#.\r\n\r\n> NOTE: You might first need to install [VS 2012 SDK](http://www.microsoft.com/en-us/download/details.aspx?id=30668) for Roslyn CTP extension to be installed successfully\r\n\r\n### Writing your first task\r\n\r\nOpen up you favorite text editor and enter the following code:\r\n\r\n```cs\r\n[Task] public static void Welcome()\r\n{\r\n\tConsole.WriteLine(\"Hello, world!\");\r\n}\r\n```\r\nSave it to the root folder of your solution and give file `Nake.csx` name. Now you can invoke your task from command line by using Nake console application.\r\n\r\n> NOTE: If you installed Nake via NuGet package manager console in Visual Studio, during an installation a sample script (`Nake.csx`) was created in the root directory of your solution. You can use it as the starting point.\r\n\r\n### Invoking task via command line\r\n\r\nTo invoke a task from a command line you just need to pass it's name to the Nake's console application. Task names are case insensitive, so to invoke the task you've just created, simply execute the following in your favorite console:\r\n\r\n\tNake welcome\r\n\r\nYou should see the following output:\r\n\r\n\tHello, world!\r\n\r\nCool, ya? :grimacing: \r\n\r\nThat for sure will only work if you have `Nake.exe` somewhere in your path. That's not good as Nake should be used as local dependency. Assuming that you have installed it via NuGet, your actual path might look like the one below:\r\n\r\n\tPackages\\Nake.1.0.0.7\\tools\\net45\\Nake.exe welcome\r\n\r\nThat, without doubt, is tedious to enter every time you want to invoke a task, but there is nothing in the world that cannot be fixed with a duct tape and bit of cleverness. Let's create a simple batch file which will act as the proxy for running Nake. Create `Nake.bat` file in the root directory of your solution and put there the text below:\r\n\r\n\t@ECHO OFF \r\n\tPackages\\Nake.1.0.0.7\\tools\\net45\\Nake.exe %*\r\n\r\nNow you have an easy (and recommended) way to launch Nake.\r\n\r\n> NOTE: If you installed Nake via NuGet package manager console in Visual Studio, during an installation a sample batch runner file (`Nake.bat`) was created in the root directory of your solution. if that didn't happen - check Nake `samples` directory inside respective package folder. \r\n\r\n### Describing tasks\r\n\r\nNow if you invoke Nake with `-T` switch it should show you all tasks defined in the script. Nevertheless, running it for the script which we've just created will produce no output. Why is that? Well, that's because by default Nake won't list tasks that don't have descriptions.\r\n\r\nNow guess how can we give a meaningful descriptions to our tasks, which are simply methods? Right, you will just use standard XML documentation comments:  \r\n\r\n```cs\r\n/// <summary>\r\n/// This is a demo task\r\n/// </summary>\r\n[Task] public static void Welcome()\r\n{\r\n\tConsole.WriteLine(\"Hello, world!\");\r\n}\r\n```\r\n\r\nNow if you run Nake with `-T` switch you should see the following output: \r\n\r\n\tC:\\Demo>Nake -T\r\n\t\r\n\tNake welcome  # This is a demo task\r\n\r\n\r\n### Passing arguments to a task\r\n\r\nWith Nake, it's ridiculously easy to define task parameters and pass them to a task from a command line. \r\n\r\n```cs\r\n\r\n[Task] public static void Welcome(string who)\r\n{\r\n\tConsole.WriteLine(\"Hello, {0}!\", who);\r\n}\r\n```\r\n\r\nNow you can simply invoke it using the following command-line:\r\n\r\n\tNake welcome amigo\r\n\r\nThat will print as expected:\r\n\r\n\tHello, amigo!\r\n\r\nNake also supports optional parameters, so you can define the task above as follows:\r\n\r\n```cs\r\n[Task] public static void Welcome(string who = \"baby\", string greeting = \"Hello\")\r\n{\r\n\tConsole.WriteLine(\"{0}, {1}!\", greeting, who);\r\n}\r\n```\r\n\r\nInvoking it with the following command line:\r\n\r\n\tNake welcome greeting: \"Hasta la vista\"\r\n\r\nWill produce the following output:\r\n\r\n\tHasta la vista, baby!\r\n\r\n> NOTE: At the moment Nake supports the following parameter types: bool, string and int. Support for `params` arrays and some other types is on a road-map.  Nevertheless, it's possible to code pretty much anything with just the types already supported by Nake.\r\n\r\n### Specifying prerequisite tasks (dependencies)\r\n\r\nSuppose we have the following build related tasks defined in a script:\r\n\r\n```cs\r\n[Task] public static void Clean()\r\n{\r\n\t// here goes code, which cleans build output directory\r\n}\r\n\r\n[Task] public static void Build(string configuration = \"Debug\")\r\n{\r\n\t// here goes code, which builds sources using given configuration\r\n}\r\n```\r\n\r\nWe want to specify that the `Clean()` task should always be executed before the `Build()` task is executed. Regarding to this, we can say that the `Clean()` task is the *prerequisite* of the `Build()` task or that the `Build()` task is *dependent* on the `Clean()` task. \r\n\r\nNow, how can we specify that relationship in Nake script? That `Build()` task is dependent on the `Clean()` task? Check out the following example:\r\n\r\n```cs\r\n[Task] public static void Clean()\r\n{\r\n\t// here goes code, which cleans build output directory\r\n}\r\n\r\n[Task] public static void Build(string configuration = \"Debug\")\r\n{\r\n\tClean();\r\n\r\n\t// here goes code, which builds sources using given configuration\r\n}\r\n```\r\nYes, it's just a regular method call. There is no any special syntax in Nake for specifying prerequisites - you simply invoke one task from within another task using native C# language constructs. Everything is 100% statically bound. No strings whatsoever, and you can put task invocations in any place you want (so that you can easily replicate advanced MSBuild features like [Before/After targets](http://freetodev.wordpress.com/2009/06/24/msbuild-4-0-beforetargets-and-aftertargets/) :grin:). \r\n\r\n##### How does it work?\r\n\r\nDOC: Describe how Nake is unique in its approach to specifying tasks and their prerequisites, and how it extends C# language semantics in order to implement dependency based style of computation ([link](http://martinfowler.com/articles/rake.html#DependencyBasedProgramming)), while still keeping its DSL (pure C#) rather imperative. Describe how Nake uses Roslyn's syntax re-writing features to rewrite task invocations.\r\n\r\n### Namespaces\r\nDOC\r\n\r\n## Other mind-blowing features (at a glance)\r\n\r\n#### String literal expansions\r\nDOC\r\n\r\n#### Command line overrides\r\nDOC \r\n\r\n#### MSBuild interoperability\r\nDOC\r\n\r\n#### Powerful utility library\r\nDOC\r\n\r\n## Other useful features\r\n\r\n- **Cycle dependencies detection** - DOC\r\n- **Roslyn bootstrapping** - DOC\r\n\r\n## General scripting\r\n\r\nDOC: Point to relevant topics in scriptcs documentation\r\n\r\n## Working with command line\r\n\r\nGeneral syntax is: `Nake [options ...]  [VAR=VALUE ...]  [task ...]`\r\n\r\nOptions:\r\n\r\n\t   -?  --help             Display help message and exit\r\n\t   -v  --version          Display the program version and exit\r\n\t   -q  --quiet            Do not echo informational messages to standard output\r\n\t   -s  --silent           Same as --quiet but also suppresses user generated log messages\r\n\t   -f  --nakefile FILE    Use FILE as the Nake project file\r\n\t   -d  --directory DIR    Use DIR as current directory\r\n\t   -t  --trace            Enables task execution tracing and full stack traces in exception messages\r\n\t       --debug            Enables full script debugging in Visual Studio\r\n\t   -T  --tasks [PATTERN]  Display the tasks with descriptions matching optional PATTERN and exit\r\n\r\n>NOTE: You can always get help for command line usage by running Nake with `-?` or `--help` switches.\r\n\r\n#### Setting environment variables\r\n\r\nYou can set process-level environment variables by defining key/value pairs before task name:\r\n\r\n```\r\nNake CpuCount=2 OutDir=C:\\Temp scan \r\n```\r\n\r\n#### Overriding constants\r\n\r\nAn interesting feature of Nake, is that it allows you to override value of any public constant or public static property, by simply passing a corresponding key/value pair from a command line, like in previous example:\r\n\r\n```\r\nNake CpuCount=2 OutDir=C:\\Temp scan \r\n```\r\nYou can get these values using built-in utility class:\r\n\r\n```cs\r\nvar cpuCount = Env.Var[\"CpuCount\"] ?? 1;\r\nvar outDir = Env.Var[\"OutDir\"] ?? \"Output\";\r\n```\r\nThis is similar to MSBuild way of having overridable variables with fallback values. But in Nake, it is enough to just declare public constants or public static properties, and Nake will try to match property names with those coming from a command line, overriding those which match: \r\n\r\n```cs\r\npublic const int CpuCount = 1;\r\npublic static string OutDir = \"Output\";\r\n```\r\nDeclaring constants could be more handy, as you can use them as default parameter values: \r\n\r\n```cs\r\n[Task] public static void Clean(string dir = OutDir) { ... }\r\n```\r\n\r\n#### Passing arguments to tasks \r\n\r\nUse space to separate arguments. Both positional and named arguments are supported. The command line syntax is the same as regular C# method calling syntax, except space is used as separator (instead of `,`):\r\n\r\n```\r\nNake db.migrate MainDb version:10002 \r\n```\r\n> NOTE: Use double quotes, if the value you're passing contains colon `:` (ie `Nake clean dir:\"C:\\Temp\"`). Also, don't forget to properly escape symbols, which have special meaning in your shell.  \r\n\r\n#### Calling multiple tasks \r\n\r\nYou can call multiple tasks, within one session, by simply separating them with semicolon `;`:\r\n\r\n```\r\nNake clean;build;test \r\n```\r\n> NOTE: In some shells, like PowerShell, semicolon (`;`) need to be escaped. For PowerShell it should be escaped with a backtick `;.\r\n\r\n## Backlog\r\n\r\n- Running on Mono\r\n- Support for additional parameter types, such as `params`\r\n- Ask for required arguments, ala PowerShell\r\n- Interactive mode, task name tab completion\r\n- PowerShell hosting\r\n- On-demand script loader\r\n- Once Roslyn finally start respecting #load directive, move both Meta and Utility to `.csx` files, so global install is possible\r\n\r\n## Contributing\r\n\r\n**Bugs** - no need to ask anything, just fix it and do a pull request\r\n\r\n**Features** - ideally should be discussed via GitHub issues or Nake's discussion group to avoid duplicate work and to make sure that new stuff is still inline with original vision.\r\n\r\n## Samples and Documentation\r\n\r\nHave a look at [Nake.csx](https://github.com/yevhen/Nake/blob/master/Nake.csx) or [Publish.csx](https://github.com/yevhen/Nake/blob/master/Publish.csx). Those are the Nake files used to build and publish Nake itself (ye, we're eating our own dog food). Also, additional samples can be contributed to samples [repository](https://github.com/yevhen/Nake-samples). Detailed documentation (soon) can be found on [wiki](https://github.com/yevhen/Nake/wiki). \r\n\r\n## Community\r\n\r\nGeneral discussion group could be found [here](https://groups.google.com/forum/#!forum/naketool). Also, for news you can follow Nake's [official](https://twitter.com/NakeTool) twitter account (or [my](https://twitter.com/yevhen) account for that matter). The twitter's hashtag is `#naketool`.\r\n\r\n## Credits\r\n- To all contributors (check out GitHub statistics)!\r\n- Thanks to all members of the [scriptcs](https://github.com/scriptcs) team for lending me their script pre-processing code\r\n- Special thanks to [Anton Martynenko](https://twitter.com/aamartynenko) for giving me an idea and steering Nake's DSL in the right direction\r\n- Hugs and kisses to my lovely Valery for being so patient and supportive, and for feeding me food and beer, while I was sitting in my cage working on Nake, instead of spending that time with her\r\n\r\n## License\r\n\r\nApache 2 License","google":"UA-46291804-1","note":"Don't delete this file! It's used internally to help with page regeneration."}